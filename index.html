<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Wall | p5.js Implementation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        header {
            background: rgba(0, 0, 0, 0.7);
            padding: 1.5rem 0;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 0;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            width: 100%;
        }
        
        .nav-btn {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .nav-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
            background: rgba(255, 255, 255, 0.2);
        }
        
        .nav-btn i {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        
        .nav-btn span {
            font-size: 1.1rem;
        }
        
        .upload-btn {
            background: linear-gradient(135deg, rgba(255, 126, 95, 0.7), rgba(254, 180, 123, 0.7));
        }
        
        .browse-btn {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.7), rgba(0, 242, 254, 0.7));
        }
        
        #photoCanvas {
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            margin: 1rem 0;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .upload-section {
            display: none;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            max-width: 800px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .upload-area {
            border: 3px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .upload-area:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .upload-area i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.8;
        }
        
        .upload-text {
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
        }
        
        .btn {
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(106, 17, 203, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(106, 17, 203, 0.4);
        }
        
        .back-btn {
            background: rgba(108, 117, 125, 0.7);
            margin-top: 1rem;
        }
        
        .browse-section {
            display: none;
            margin: 2rem 0;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .browse-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 2rem;
        }
        
        .browse-item {
            aspect-ratio: 1;
            overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .browse-item:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
        }
        
        .browse-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        footer {
            text-align: center;
            padding: 2rem 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            margin-top: 3rem;
            backdrop-filter: blur(10px);
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.8rem;
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        @media (max-width: 768px) {
            .nav-buttons {
                flex-direction: column;
                align-items: center;
                gap: 1rem;
            }
            
            .nav-btn {
                width: 130px;
                height: 130px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            #photoCanvas {
                width: 95% !important;
                height: auto !important;
            }
        }
        
        @media (max-width: 480px) {
            .nav-btn {
                width: 120px;
                height: 120px;
            }
            
            .nav-btn i {
                font-size: 2.5rem;
            }
            
            .upload-section, .browse-section {
                padding: 1rem;
            }
            
            .upload-area {
                padding: 2rem 1rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>p5.js Photo Wall</h1>
            <p class="subtitle">Upload, share, and discover beautiful moments</p>
        </div>
    </header>
    
    <div class="container">
        <!-- Main Page - Photo Wall -->
        <section id="mainPage" class="main-content">
            <div class="nav-buttons">
                <div class="nav-btn upload-btn" id="uploadNavBtn">
                    <i>üì§</i>
                    <span>Upload Photos</span>
                </div>
                
                <div class="nav-btn browse-btn" id="browseNavBtn">
                    <i>üîç</i>
                    <span>Browse More</span>
                </div>
            </div>
            
            <div id="photoCanvasContainer">
                <!-- p5.js canvas will be created here -->
            </div>
        </section>
        
        <!-- Upload Photos Page -->
        <section id="uploadPage" class="upload-section">
            <h2 class="section-title">Upload Photos</h2>
            <div class="upload-area" id="uploadArea">
                <i>üì∑</i>
                <p class="upload-text">Drag and drop photos here, or click to select files</p>
                <input type="file" id="fileInput" accept="image/*" multiple style="display: none;">
                <button class="btn" id="uploadBtn">Select Photos</button>
            </div>
            <button class="btn back-btn" id="backFromUpload">Back to Photo Wall</button>
        </section>
        
        <!-- Browse More Page -->
        <section id="browsePage" class="browse-section">
            <h2 class="section-title">All Photos</h2>
            <div class="browse-grid" id="browseGrid">
                <!-- Photos will be dynamically added via JavaScript -->
            </div>
            <button class="btn back-btn" id="backFromBrowse">Back to Photo Wall</button>
        </section>
    </div>
    
    <footer>
        <div class="container">
            <p>¬© 2023 p5.js Photo Wall | Interactive photo sharing platform built with p5.js</p>
        </div>
    </footer>

    <script>
        // Initialize photos array
        let photos = JSON.parse(localStorage.getItem('photos')) || [];
        let photoImages = []; // Store p5.Image objects
        
        // Add some sample photos (if no photos exist)
        const samplePhotos = [
            'https://images.unsplash.com/photo-1506744038136-46273834b3fb',
            'https://images.unsplash.com/photo-1501785888041-af3ef285b470',
            'https://images.unsplash.com/photo-1441974231531-c6227db76b6e',
            'https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05',
            'https://images.unsplash.com/photo-1465146344425-f00d5f5c8f07',
            'https://images.unsplash.com/photo-1439853949127-fa647821eba0',
            'https://images.unsplash.com/photo-1475924156734-496f6cac6ec1',
            'https://images.unsplash.com/photo-1418065460487-3e41a6c84dc5',
            'https://images.unsplash.com/photo-1501854140801-50d01698950b',
            'https://images.unsplash.com/photo-1447752875215-b2761acb3c5d',
            'https://images.unsplash.com/photo-1476820865390-c52aeebb9891',
            'https://images.unsplash.com/photo-1469474968028-56623f02e42e',
            'https://images.unsplash.com/photo-1506905925346-21bda4d32df4',
            'https://images.unsplash.com/photo-1433086966358-54859d0ed716',
            'https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd',
            'https://images.unsplash.com/photo-1426604966848-d7adac402bff',
            'https://images.unsplash.com/photo-1506260408121-e353d10b87c7'
        ];
        
        if (photos.length === 0) {
            photos = samplePhotos;
            localStorage.setItem('photos', JSON.stringify(photos));
        }
        
        // DOM elements
        const mainPage = document.getElementById('mainPage');
        const uploadPage = document.getElementById('uploadPage');
        const browsePage = document.getElementById('browsePage');
        const uploadNavBtn = document.getElementById('uploadNavBtn');
        const browseNavBtn = document.getElementById('browseNavBtn');
        const backFromUpload = document.getElementById('backFromUpload');
        const backFromBrowse = document.getElementById('backFromBrowse');
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const uploadBtn = document.getElementById('uploadBtn');
        const browseGrid = document.getElementById('browseGrid');
        
        // p5.js canvas and variables
        let canvas;
        let gridSize = 9;
        let cellSize;
        let hoveredCell = -1;
        let selectedCell = -1;
        
        // p5.js setup function
        function setup() {
            const container = document.getElementById('photoCanvasContainer');
            const width = Math.min(800, windowWidth - 40);
            canvas = createCanvas(width, width);
            canvas.parent('photoCanvasContainer');
            canvas.id('photoCanvas');
            
            cellSize = width / gridSize;
            
            // Load all photos
            loadAllPhotos();
        }
        
        // Load all photos into p5.Image objects
        function loadAllPhotos() {
            photoImages = [];
            photos.forEach(photo => {
                let img = loadImage(photo, 
                    () => {
                        // Image loaded successfully
                        console.log('Image loaded successfully');
                    },
                    () => {
                        // Image failed to load, use default image
                        console.log('Image failed to load, using default image');
                        createDefaultImage();
                    }
                );
                photoImages.push(img);
            });
        }
        
        // Create default image
        function createDefaultImage() {
            let img = createGraphics(100, 100);
            img.background(100);
            img.fill(255);
            img.textAlign(CENTER, CENTER);
            img.text('Image\nFailed', 50, 50);
            return img;
        }
        
        // p5.js draw function
        function draw() {
            background(30, 30, 40, 200);
            
            // Draw grid
            drawPhotoGrid();
            
            // Draw hover effect
            if (hoveredCell !== -1) {
                drawHoverEffect(hoveredCell);
            }
            
            // Draw title
            drawTitle();
        }
        
        // Draw photo grid
        function drawPhotoGrid() {
            for (let i = 0; i < gridSize * gridSize; i++) {
                let x = (i % gridSize) * cellSize;
                let y = Math.floor(i / gridSize) * cellSize;
                
                if (i < photoImages.length && photoImages[i]) {
                    // Draw photo
                    image(photoImages[i], x, y, cellSize, cellSize);
                } else {
                    // Draw empty cell
                    drawEmptyCell(x, y, cellSize);
                }
                
                // Draw cell border
                stroke(255, 100);
                strokeWeight(1);
                noFill();
                rect(x, y, cellSize, cellSize);
            }
        }
        
        // Draw empty cell
        function drawEmptyCell(x, y, size) {
            fill(50, 50, 60, 150);
            noStroke();
            rect(x, y, size, size);
            
            fill(150);
            textAlign(CENTER, CENTER);
            textSize(size * 0.1);
            text('Upload\nPhoto', x + size/2, y + size/2);
        }
        
        // Draw hover effect
        function drawHoverEffect(cellIndex) {
            let x = (cellIndex % gridSize) * cellSize;
            let y = Math.floor(cellIndex / gridSize) * cellSize;
            
            fill(255, 255, 255, 50);
            noStroke();
            rect(x, y, cellSize, cellSize);
            
            // Draw magnifying glass effect
            if (cellIndex < photoImages.length) {
                let zoomSize = cellSize * 2;
                let zoomX = mouseX + 20;
                let zoomY = mouseY + 20;
                
                // Ensure magnifying glass doesn't go outside canvas
                if (zoomX + zoomSize > width) zoomX = mouseX - zoomSize - 20;
                if (zoomY + zoomSize > height) zoomY = mouseY - zoomSize - 20;
                
                // Draw zoomed image
                image(photoImages[cellIndex], zoomX, zoomY, zoomSize, zoomSize);
                
                // Draw magnifying glass border
                stroke(255);
                strokeWeight(2);
                noFill();
                rect(zoomX, zoomY, zoomSize, zoomSize);
                
                // Draw connecting line
                stroke(255, 200);
                strokeWeight(1);
                line(mouseX, mouseY, zoomX + zoomSize/2, zoomY + zoomSize/2);
            }
        }
        
        // Draw title
        function drawTitle() {
            fill(255);
            textAlign(CENTER, TOP);
            textSize(24);
            text('Photo Wall (9x9)', width/2, 10);
            
            textSize(14);
            text(`${photoImages.length} photos uploaded`, width/2, 40);
        }
        
        // Mouse move event
        function mouseMoved() {
            if (mouseX < 0 || mouseX > width || mouseY < 0 || mouseY > height) {
                hoveredCell = -1;
                return;
            }
            
            let col = Math.floor(mouseX / cellSize);
            let row = Math.floor(mouseY / cellSize);
            hoveredCell = row * gridSize + col;
        }
        
        // Mouse click event
        function mouseClicked() {
            if (mouseX < 0 || mouseX > width || mouseY < 0 || mouseY > height) return;
            
            let col = Math.floor(mouseX / cellSize);
            let row = Math.floor(mouseY / cellSize);
            let clickedCell = row * gridSize + col;
            
            if (clickedCell < photoImages.length) {
                selectedCell = clickedCell;
                // In a real application, this could open a modal to show the full image
                alert(`You clicked photo ${clickedCell + 1}`);
            }
        }
        
        // Window resize event
        function windowResized() {
            const width = Math.min(800, windowWidth - 40);
            resizeCanvas(width, width);
            cellSize = width / gridSize;
        }
        
        // Initialize browse page
        function initBrowsePage() {
            browseGrid.innerHTML = '';
            
            photos.forEach((photo, index) => {
                const cell = document.createElement('div');
                cell.className = 'browse-item';
                
                const img = document.createElement('img');
                img.src = photo;
                img.alt = `User uploaded photo ${index+1}`;
                img.onclick = () => alert(`You viewed photo ${index + 1}`);
                cell.appendChild(img);
                
                browseGrid.appendChild(cell);
            });
        }
        
        // Handle file upload
        function handleFileUpload(files) {
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        photos.push(e.target.result);
                        localStorage.setItem('photos', JSON.stringify(photos));
                        
                        // Reload all photos
                        loadAllPhotos();
                        
                        // Update browse page
                        initBrowsePage();
                    };
                    
                    reader.readAsDataURL(file);
                }
            }
        }
        
        // Page navigation
        function showMainPage() {
            mainPage.style.display = 'flex';
            uploadPage.style.display = 'none';
            browsePage.style.display = 'none';
        }
        
        function showUploadPage() {
            mainPage.style.display = 'none';
            uploadPage.style.display = 'block';
            browsePage.style.display = 'none';
        }
        
        function showBrowsePage() {
            mainPage.style.display = 'none';
            uploadPage.style.display = 'none';
            browsePage.style.display = 'block';
            initBrowsePage();
        }
        
        // Event listeners
        uploadNavBtn.addEventListener('click', showUploadPage);
        browseNavBtn.addEventListener('click', showBrowsePage);
        backFromUpload.addEventListener('click', showMainPage);
        backFromBrowse.addEventListener('click', showMainPage);
        
        uploadBtn.addEventListener('click', () => {
            fileInput.click();
        });
        
        fileInput.addEventListener('change', (e) => {
            handleFileUpload(e.target.files);
            fileInput.value = ''; // Reset file input
            showMainPage(); // Return to main page after upload
        });
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.backgroundColor = 'rgba(255, 255, 255, 0.15)';
            uploadArea.style.borderColor = 'rgba(255, 255, 255, 0.7)';
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.backgroundColor = 'rgba(255, 255, 255, 0.05)';
            uploadArea.style.borderColor = 'rgba(255, 255, 255, 0.3)';
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.backgroundColor = 'rgba(255, 255, 255, 0.05)';
            uploadArea.style.borderColor = 'rgba(255, 255, 255, 0.3)';
            handleFileUpload(e.dataTransfer.files);
            showMainPage(); // Return to main page after upload
        });
        
        // Initialize
        showMainPage();
    </script>
</body>
</html>